using System;
using System.Runtime.InteropServices;
using System.Security.Cryptography;

namespace onrkn;

internal sealed class pothu
{
	public struct rpyum
	{
		public IntPtr pvqfg;

		public IntPtr uxwcu;

		public int hctow;

		public uint wgppb;

		public int upjck;

		public IntPtr anfzc;

		public int lbski;
	}

	public struct mzdxs
	{
		public int pwqgd;

		public IntPtr vkfqu;
	}

	public struct ddghv
	{
		public ushort caaeb;

		public mzdxs daeeh;
	}

	public struct nhkqk
	{
		public IntPtr ggflp;

		public ddghv rjonk;
	}

	public struct swccb
	{
		public byte wcppq;

		public byte lukil;

		public short fenkl;

		public uint ifqoc;

		public uint fwbvg;

		public uint oapfe;

		public uint hcqli;
	}

	public const byte udqjv = 2;

	public const int sfuff = 826364754;

	public const int ifeix = 0;

	public const int lawsq = 1;

	public const int gecmx = 24576;

	public const int inovg = 32768;

	public const int pyuvt = 0;

	public const int ztwjc = 1536;

	public const int rfmhf = 1;

	public const int sqbiz = 2;

	public const int bbrro = 3;

	public const int cquyy = 2;

	public const int mjdxa = 3;

	public const int zquie = 4;

	public const int vatkh = 8;

	public const int uojfw = 12;

	public const int pfsow = 13;

	public const int kzhoh = 14;

	public const int frnga = 9216;

	public const int rkpxv = 41984;

	public const int gnoyi = 8704;

	public const int uulse = 32770;

	public const int jupmb = 32771;

	public const int grpee = 32772;

	public const int drtdg = 32776;

	public const int lidgt = 26114;

	public const int hqxdz = 26113;

	public const int bmbrn = 26115;

	public const int khagc = 32780;

	public const int pcbvx = 32781;

	public const int wuxoy = 32782;

	public const int aleli = 43522;

	public const uint ulrew = 1u;

	public const uint uyxjx = 2u;

	public const uint ayyhq = 8u;

	public const uint ibwku = 16u;

	public const uint pkxzi = 32u;

	public const uint fmqtp = 64u;

	public const uint cavxu = 4096u;

	public const uint ahgtu = 256u;

	public const uint jjgho = 512u;

	public const uint ydawo = 16384u;

	public const uint angvk = 32768u;

	public const uint bdhax = 458752u;

	public const uint qpskv = 65536u;

	public const uint xyqku = 131072u;

	public const uint zogrx = 262144u;

	public const uint ugyjs = 4026531840u;

	public const uint scciu = 64u;

	public const int sruqo = 1;

	public const int uajcj = 2;

	public const int qunqb = 4;

	public const int cyrpx = 7;

	public const int nmiwh = 8;

	public const int xeybw = 16;

	public const int lsqqr = 32;

	public const int ogahr = 64;

	public const int shdcw = 128;

	public const int zvzoe = 256;

	public const int iawzw = 512;

	public const int yrlac = 1024;

	public const int rtyru = 2048;

	public const int lfuoy = 3840;

	public const int rnpxv = 4095;

	public const int windy = 32768;

	public const int tavwj = 16384;

	public const int zfdov = 53247;

	public const int wybui = 65536;

	public const int hjsko = 131072;

	public const int bhimz = 0;

	public const int hygss = 1;

	public const int wsbsm = 2;

	public const int pvffk = 4;

	public const int hdtjx = 8;

	public const int iaiux = 16;

	public const int fpefp = 32;

	public const int jzauo = 64;

	public const int brlpo = 128;

	public const int iffow = 256;

	public const int xupbq = 512;

	public const int rgacc = 1024;

	public const int apwua = 2048;

	public const int bltis = 4096;

	public const int jzgbh = 8192;

	public const int wsind = 16384;

	public const int kqcbv = 32768;

	public const int peosg = 65536;

	public const int kzuvf = 131072;

	public const int ivpes = 262144;

	public const int cmmue = 524288;

	public const int hvdqu = 1048576;

	public const int twfbc = 16777216;

	public const int cicwm = 33554432;

	public const int modcl = 67108864;

	public const int spsbn = 134217728;

	public const int ovvdq = 253755391;

	public const int qadhy = 1;

	public const int yizmk = 2;

	public const int dwadd = 4;

	public const int fegly = 8;

	public const int vrkcv = 256;

	public const int cqzoh = 512;

	public const int htjdh = 1024;

	public const int wmtxk = 65536;

	public const int mufrx = 4;

	public const uint itymh = 16u;

	public const int rkzsj = 1;

	public const int fkzfw = 2;

	public const int biuji = 4;

	public const int dhtyb = 16;

	public const int cvaxt = 32;

	public const int qrqne = 64;

	public const int gkhaw = 128;

	public const int ktnwi = 256;

	public const int qjvaq = 512;

	public const int iikfv = 1024;

	public const int wdyin = 2048;

	public const int wukzo = 32768;

	public const int qddrr = 16384;

	public const int hrfpp = 8192;

	public const int tltlh = 4096;

	public const int sstto = -2146762495;

	public const int uhcps = -2146762494;

	public const int kofzy = -2146762493;

	public const int muyzp = -2146762492;

	public const int afvdg = -2146762491;

	public const int qnrhk = -2146762490;

	public const int zmgzt = -2146762489;

	public const int wsfwq = -2146762488;

	public const int euwvl = -2146762487;

	public const int ojtvz = -2146762486;

	public const int jappq = -2146762485;

	public const int stwpp = -2146762484;

	public const int plpmp = -2146762483;

	public const int bozoy = -2146762482;

	public const int xbspo = -2146762481;

	public const int vahmh = -2146762480;

	public const int rycky = -2146762479;

	public const int fcgbd = -2146762478;

	public const int pagge = -2146762477;

	public const int eshvc = -2146762476;

	public const int plknu = -2146885628;

	public const int htrsq = -2146885621;

	public const int omqwj = -2146885616;

	public const int pwcjh = -2146885614;

	public const int vynjt = -2146885613;

	public const int fldzr = -2146885627;

	public const int xhhvu = -2146893821;

	public const int jayyj = -2146893819;

	public const int zlgcr = -2146893818;

	public const int cunfr = -2146893816;

	public const int gsjtt = -2146893813;

	public const int dfsnw = -2146893811;

	public const int yttht = -2146893802;

	public const int tkcqs = -2146893799;

	public const int damnd = -2146893795;

	public const int hugvq = -2146893790;

	public const int lgxvz = 8;

	public const int jsnml = 87;

	public const int yfvua = -2147024891;

	public const int rzfcu = -2146869246;

	public const int dgvya = -2146869244;

	public const int eohpg = -2146869232;

	public const int vjdpt = -2146869223;

	public const int esfps = 128;

	public const int wkkkh = 64;

	public const int yoega = 32;

	public const int kjcvs = 16;

	public const int mqfmm = 8;

	public const int zlpwf = 4;

	public const int hmymv = 2;

	public const int yzkul = 2;

	public const int jzxon = 1;

	public const int gkbnq = 128;

	public const int lxfxp = 1;

	public const int yamtb = 2;

	public const int sqmku = 2;

	public const int xawyi = 3;

	public const int jziab = 4;

	public const int uxcua = 6;

	public const int nmzxl = 9;

	public const int gvhrl = 10;

	public const int vrkuq = 13;

	public const int jooqr = 1;

	public const int mizhj = 2;

	public const int qwywv = 3;

	public const int vqgzm = 4;

	public const int ftymr = 5;

	public const int hvrbv = 6;

	public const int fcdjv = 7;

	public const uint anuje = 1u;

	public const uint vjixl = 2u;

	public const uint egmee = 4u;

	public const uint vmaas = 8u;

	public const uint soyfu = 16u;

	public const uint eenxv = 32u;

	public const uint fivmj = 268435456u;

	public const uint apbyd = 536870912u;

	public const uint fcgik = 1073741824u;

	public const uint hddys = 2147483648u;

	public const int kxypz = 1;

	public const int jbelb = 2;

	public const int fldhg = 3;

	public const int xwzhd = 4;

	public const int tsefj = 5;

	public const int dvaqm = 6;

	public const int tlrto = 7;

	public const int yybme = 8;

	public const int fvatn = 1;

	public const int jieep = 2;

	public const int cvglt = 3;

	public const int dyyyp = 4;

	public const int xmhui = 5;

	public const int tpqro = 6;

	public const int egsph = 7;

	public const int sddco = 8;

	public const int nsgxp = 9;

	public const int cxwuh = 10;

	public const int cyewv = 11;

	public const int vmqwe = 65535;

	public const int xcpmi = 16;

	public const int kglvc = 0;

	public const int zopxq = 1;

	public const int lyflz = 2;

	public const int wmpyr = 3;

	public const int imysj = 4;

	public const int jdvto = 5;

	public const int zhygp = 6;

	public const int flepa = 1;

	public const int xfxhx = 7;

	public const int yddds = 8;

	public const int vxjmo = 9;

	public const int fkuoh = 10;

	public const int ztwui = 10;

	public const int alype = 11;

	public const int pziik = 12;

	public const int fayxf = 13;

	public const int nhljd = 14;

	public const int jkyjx = 15;

	public const int ptlkk = 16;

	public const int skprk = 17;

	public const int vxxkc = 18;

	public const int lvvbk = 0;

	public const int mvwdn = 65536;

	public const int tqnrs = 262144;

	public const int nagnt = 917504;

	public const int ivaao = 983040;

	public const int dyllg = 65536;

	public const int wogdh = 327680;

	public const int arxdh = 393216;

	public const int qhgeh = 131079;

	public const int zltrr = 196615;

	public const int wxsiy = 131076;

	public const int xyxpr = 196612;

	public const int odxyl = 458759;

	public const int dycnc = 524295;

	public const int xghfm = 524295;

	public const int voucn = 458756;

	public const int qwdpo = 524292;

	public const int yhoiq = 524292;

	public const int bqmbp = 589824;

	public const int vtveo = 655360;

	public const int sahki = 655360;

	public const int fpzwf = 720896;

	public const int qulug = 786432;

	public const int eygml = 851968;

	public const int wukji = 1048576;

	public const int kjiai = 1114112;

	public const int fzoxj = 1179648;

	public const int nilfl = 1;

	public const int otlmz = 3;

	public const int yjbzg = 5;

	public const int dlwyj = 3;

	public const int dmgqf = 4;

	public const int nowjq = 3;

	public const int ctlha = 1;

	public const int hnoqk = 65536;

	public const int tdqju = 1;

	public const int ltsue = 2;

	public const int ovblw = 64;

	public const int dvysx = 1;

	public const int bscfi = 4;

	public const int onukg = 5;

	public const int lvhcs = 11;

	public const int fmatf = 12;

	public const int ddaff = 13;

	public const int fkrir = 14;

	public const int hkxew = 15;

	public const int gtgkx = 7;

	public const int pjhla = 1;

	public const int empag = 0;

	public const int gllcj = 1;

	public const int pkcry = 2;

	public const int nicri = 12;

	public const int plvhm = 13;

	public const int rzhhh = 24;

	public const byte uyctr = 6;

	public const int xmxbi = 7;

	public const int bcysf = 2;

	public const int zyumf = 1;

	public const int xfciv = 3;

	public const int oapzg = 8;

	public const int nfrau = 3;

	public const int gvjkp = 1;

	public const int vmtux = 2;

	public const int veumd = 78;

	public const int ddbsd = 1;

	public const int ynnmr = 2;

	public const int gqglt = 3;

	public const int hesea = 1073741824;

	public const int vcedj = 536870912;

	public const int cjhsn = 268435456;

	public const int iolza = 134217728;

	public const int qlzah = 67108864;

	public const int waqih = 33554432;

	public const int weoaz = 65536;

	public const int mwqrt = 131072;

	public const int eojdo = 262144;

	public const int qgbfs = 1;

	public const int kplhd = 2;

	public const int euqdi = 4;

	public const int vujfo = -1;

	private static readonly object ziyyr = new object();

	private static bool? kmsjr;

	public static int qnnwg = 0;

	public static uint jvmpf = 0u;

	public static bool aicde
	{
		get
		{
			bool? flag = kmsjr;
			if (flag.HasValue && 0 == 0)
			{
				return flag.Value;
			}
			lock (ziyyr)
			{
				if (!kmsjr.HasValue || 1 == 0)
				{
					switch (Environment.OSVersion.Platform)
					{
					case PlatformID.Win32NT:
					case PlatformID.WinCE:
						kmsjr = xyeca();
						break;
					default:
						kmsjr = false;
						break;
					}
				}
				return kmsjr.Value;
			}
		}
	}

	private static bool xyeca()
	{
		if (dahxy.umrab && 0 == 0)
		{
			return false;
		}
		try
		{
			kayvw();
			return true;
		}
		catch
		{
			return false;
		}
	}

	private static void kayvw()
	{
		if (qfori(out var p, null, null, 0, 0u) != 0 && 0 == 0)
		{
			obsxv(p, 0);
		}
	}

	public static void jrtxg(int p0)
	{
		gqrne(p0, string.Empty);
	}

	public static void gqrne(int p0, string p1)
	{
		if (p0 == 0 || 1 == 0)
		{
			int lastWin32Error = Marshal.GetLastWin32Error();
			throw new CryptographicException(brgjd.edcru("CryptoApi error: (0x{0:X8}) {1}", lastWin32Error, p1));
		}
	}

	public static void prykp(int p0)
	{
		if (p0 != 0 && 0 == 0)
		{
			throw new CryptographicException(brgjd.edcru("CNG error (0x{0:X8}).", p0));
		}
	}

	[DllImport("crypt32.dll", CharSet = CharSet.Unicode, EntryPoint = "CertNameToStrW", SetLastError = true)]
	public static extern int CertNameToStr(uint dwCertEncodingType, IntPtr pName, uint dwStrType, IntPtr psz, int csz);

	[DllImport("crypt32.dll", CharSet = CharSet.Unicode, EntryPoint = "CertStrToNameW", SetLastError = true)]
	public static extern int CertStrToName(uint dwCertEncodingType, string pszX500, uint dwStrType, IntPtr pvReserved, byte[] pbEncoded, ref int pcbEncoded, IntPtr ppszError);

	[DllImport("crypt32.dll", CharSet = CharSet.Unicode, SetLastError = true)]
	public static extern IntPtr CertOpenStore(IntPtr lpszStoreProvider, int dwMsgAndCertEncodingType, IntPtr hCryptProv, int dwFlags, string pvPara);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern int CertCloseStore(IntPtr hCertStore, int dwFlags);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern int CertAddCertificateContextToStore(IntPtr hCertStore, IntPtr pCertContext, int dwAddDisposition, IntPtr ppStoreContext);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern int CertDeleteCertificateFromStore(IntPtr pCertContext);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern IntPtr CertEnumCertificatesInStore(IntPtr hCertStore, IntPtr pPrevCertContext);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern int CryptAcquireCertificatePrivateKey(IntPtr pCert, uint dwFlags, IntPtr pvReserved, out IntPtr phCryptProv, out int pdwKeySpec, out int pfCallerFreeProv);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern int CryptFindCertificateKeyProvInfo(IntPtr pCert, uint dwFlags, IntPtr pvReserved);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern int CertFreeCertificateContext(IntPtr pCertContext);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern IntPtr CertDuplicateCertificateContext(IntPtr pCertContext);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern int CertGetCertificateContextProperty(IntPtr pCertContext, int dwPropId, IntPtr pvData, out int pcbData);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern IntPtr CertFindCertificateInStore(IntPtr hCertStore, int dwCertEncodingType, int dwFindFlags, int dwFindType, IntPtr pvFindPara, IntPtr pPrevCertContext);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern IntPtr CertCreateCertificateContext(int dwCertEncodingType, byte[] pbCertEncoded, int cbCertEncoded);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern int CertGetCertificateChain(IntPtr hChainEngine, IntPtr pCertContext, IntPtr pTime, IntPtr hAdditionalStore, ref nhkqk pChainPara, uint dwFlags, IntPtr pvReserverd, out IntPtr ppChainContext);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern void CertFreeCertificateChain(IntPtr pChainContext);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern int CertGetIntendedKeyUsage(int dwCertEncodingType, IntPtr pCertInfo, out int pbKeyUsage, int cbKeyUsage);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern int CertGetEnhancedKeyUsage(IntPtr pCertContext, uint dwFlags, IntPtr pUsage, ref int pcbUsage);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern int CertSetCertificateContextProperty(IntPtr pCertContext, int dwPropId, int dwFlags, ref rpyum pvData);

	[DllImport("crypt32.dll", CharSet = CharSet.Unicode, SetLastError = true)]
	public static extern IntPtr PFXImportCertStore(IntPtr pPfx, string szPassword, uint dwFlags);

	[DllImport("crypt32.dll", CharSet = CharSet.Unicode, SetLastError = true)]
	public static extern int PFXExportCertStoreEx(IntPtr hStore, IntPtr pPfx, string szPassword, IntPtr pvReserved, uint dwFlags);

	[DllImport("crypt32.dll", CharSet = CharSet.Unicode, SetLastError = true)]
	public static extern int PFXVerifyPassword(IntPtr pPfx, string szPassword, int dwFlags);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern int PFXIsPFXBlob(IntPtr pPfx);

	[DllImport("kernel32.dll", EntryPoint = "RtlZeroMemory")]
	private static extern bool ZeroMemoryNT(IntPtr Destination, int Length);

	public static void hfdek(IntPtr p0, int p1)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			memset(p0, 0u, (uint)p1);
		}
		else
		{
			ZeroMemoryNT(p0, p1);
		}
	}

	public static int qfori(out IntPtr p0, string p1, string p2, int p3, uint p4)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptAcquireContextCE(out p0, p1, p2, p3, p4);
		}
		return CryptAcquireContextNT(out p0, p1, p2, p3, p4);
	}

	public static int obsxv(IntPtr p0, int p1)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptReleaseContextCE(p0, p1);
		}
		return CryptReleaseContextNT(p0, p1);
	}

	public static int pmwpt(IntPtr p0, uint p1, out IntPtr p2)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptGetUserKeyCE(p0, p1, out p2);
		}
		return CryptGetUserKeyNT(p0, p1, out p2);
	}

	public static int xdyfe(IntPtr p0)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptDestroyKeyCE(p0);
		}
		return CryptDestroyKeyNT(p0);
	}

	public static int fclhh(IntPtr p0, int p1, IntPtr p2, int p3, out IntPtr p4)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptCreateHashCE(p0, p1, p2, p3, out p4);
		}
		return CryptCreateHashNT(p0, p1, p2, p3, out p4);
	}

	public static int sxrxx(IntPtr p0)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptDestroyHashCE(p0);
		}
		return CryptDestroyHashNT(p0);
	}

	public static int ufoji(IntPtr p0, byte[] p1, int p2, int p3)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptHashDataCE(p0, p1, p2, p3);
		}
		return CryptHashDataNT(p0, p1, p2, p3);
	}

	public static int bmpgj(IntPtr p0, int p1, byte[] p2, int p3)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptSetHashParamCE(p0, p1, p2, p3);
		}
		return CryptSetHashParamNT(p0, p1, p2, p3);
	}

	public static int ovhzp(IntPtr p0, int p1, byte[] p2, ref int p3, int p4)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptGetHashParamCE(p0, p1, p2, ref p3, p4);
		}
		return CryptGetHashParamNT(p0, p1, p2, ref p3, p4);
	}

	public static int kqejz(IntPtr p0, int p1, IntPtr p2, int p3, byte[] p4, ref int p5)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptSignHashCE(p0, p1, p2, p3, p4, ref p5);
		}
		return CryptSignHashNT(p0, p1, p2, p3, p4, ref p5);
	}

	public static int iukzl(IntPtr p0, IntPtr p1, int p2, int p3, byte[] p4, ref int p5)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptDecryptCE(p0, p1, p2, p3, p4, ref p5);
		}
		return CryptDecryptNT(p0, p1, p2, p3, p4, ref p5);
	}

	public static int lwvkz(IntPtr p0, IntPtr p1, int p2, IntPtr p3, int p4, out IntPtr p5)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptImportKeyCE(p0, p1, p2, p3, p4, out p5);
		}
		return CryptImportKeyNT(p0, p1, p2, p3, p4, out p5);
	}

	public static int rrqio(IntPtr p0, IntPtr p1, int p2, int p3, IntPtr p4, ref int p5)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptExportKeyCE(p0, p1, p2, p3, p4, ref p5);
		}
		return CryptExportKeyNT(p0, p1, p2, p3, p4, ref p5);
	}

	public static int sfbuy(IntPtr p0, int p1, IntPtr p2, int p3)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptSetKeyParamCE(p0, p1, p2, p3);
		}
		return CryptSetKeyParamNT(p0, p1, p2, p3);
	}

	public static int respo(IntPtr p0, int p1, byte[] p2, int p3)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptSetKeyParamCE(p0, p1, p2, p3);
		}
		return CryptSetKeyParamNT(p0, p1, p2, p3);
	}

	public static int yafnh(IntPtr p0, int p1, byte[] p2)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptGenRandomCE(p0, p1, p2);
		}
		return CryptGenRandomNT(p0, p1, p2);
	}

	public static int peviy(IntPtr p0, int p1, uint p2, out IntPtr p3)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptGenKeyCE(p0, p1, p2, out p3);
		}
		return CryptGenKeyNT(p0, p1, p2, out p3);
	}

	public static int dwkha(IntPtr p0, int p1, byte[] p2, ref int p3, int p4)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptGetProvParamCE(p0, p1, p2, ref p3, p4);
		}
		return CryptGetProvParamNT(p0, p1, p2, ref p3, p4);
	}

	public static int gciab(IntPtr p0, byte[] p1, int p2, IntPtr p3, IntPtr p4, int p5)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptVerifySignatureCE(p0, p1, p2, p3, p4, p5);
		}
		return CryptVerifySignatureNT(p0, p1, p2, p3, p4, p5);
	}

	public static int ekfve(IntPtr p0, IntPtr p1, int p2, int p3, IntPtr p4, ref int p5, int p6)
	{
		if (Environment.OSVersion.Platform == PlatformID.WinCE)
		{
			return CryptEncryptCE(p0, p1, p2, p3, p4, ref p5, p6);
		}
		return CryptEncryptNT(p0, p1, p2, p3, p4, ref p5, p6);
	}

	[DllImport("coredll.dll", EntryPoint = "CryptGetProvParam", SetLastError = true)]
	private static extern int CryptGetProvParamCE(IntPtr hProv, int dwParam, byte[] pbData, ref int pdwDataLen, int dwFlags);

	[DllImport("coredll.dll")]
	private static extern void memset(IntPtr pbData, uint offset, uint cbData);

	[DllImport("coredll.dll", CharSet = CharSet.Unicode, EntryPoint = "CryptAcquireContextW", SetLastError = true)]
	private static extern int CryptAcquireContextCE(out IntPtr hProv, string pszContainer, string pszProvider, int dwProvType, uint dwFlags);

	[DllImport("coredll.dll", EntryPoint = "CryptReleaseContext", SetLastError = true)]
	private static extern int CryptReleaseContextCE(IntPtr hProv, int dwFlags);

	[DllImport("coredll.dll", EntryPoint = "CryptGetUserKey", SetLastError = true)]
	private static extern int CryptGetUserKeyCE(IntPtr hProv, uint dwKeySpec, out IntPtr hUserKey);

	[DllImport("coredll.dll", EntryPoint = "CryptDestroyKey", SetLastError = true)]
	private static extern int CryptDestroyKeyCE(IntPtr hKey);

	[DllImport("coredll.dll", EntryPoint = "CryptCreateHash", SetLastError = true)]
	private static extern int CryptCreateHashCE(IntPtr hProv, int algID, IntPtr hKey, int dwFlags, out IntPtr phHash);

	[DllImport("coredll.dll", EntryPoint = "CryptDestroyHash", SetLastError = true)]
	private static extern int CryptDestroyHashCE(IntPtr hHash);

	[DllImport("coredll.dll", EntryPoint = "CryptHashData", SetLastError = true)]
	private static extern int CryptHashDataCE(IntPtr hHash, byte[] pbData, int dwDataLen, int dwFlags);

	[DllImport("coredll.dll", EntryPoint = "CryptSetHashParam", SetLastError = true)]
	private static extern int CryptSetHashParamCE(IntPtr hHash, int dwParam, byte[] pbData, int dwFlags);

	[DllImport("coredll.dll", EntryPoint = "CryptGetHashParam", SetLastError = true)]
	private static extern int CryptGetHashParamCE(IntPtr hHash, int dwParam, byte[] pbData, ref int pdwDataLen, int dwFlags);

	[DllImport("coredll.dll", EntryPoint = "CryptSignHash", SetLastError = true)]
	private static extern int CryptSignHashCE(IntPtr hHash, int dwKeySpec, IntPtr sDescription, int dwFlags, byte[] pbSignature, ref int pdwSigLen);

	[DllImport("coredll.dll", EntryPoint = "CryptDecrypt", SetLastError = true)]
	internal static extern int CryptDecryptCE(IntPtr hKey, IntPtr hHash, int final, int dwFlags, byte[] pbData, ref int pdwDataLen);

	[DllImport("coredll.dll", EntryPoint = "CryptImportKey", SetLastError = true)]
	private static extern int CryptImportKeyCE(IntPtr hProv, IntPtr pbData, int dwDataLen, IntPtr hPubKey, int dwFlags, out IntPtr phKey);

	[DllImport("coredll.dll", EntryPoint = "CryptExportKey", SetLastError = true)]
	private static extern int CryptExportKeyCE(IntPtr hKey, IntPtr hExpKey, int dwBlobType, int dwFlags, IntPtr pbData, ref int pdwbDataLen);

	[DllImport("coredll.dll", EntryPoint = "CryptSetKeyParam", SetLastError = true)]
	private static extern int CryptSetKeyParamCE(IntPtr hKey, int dwParam, IntPtr pbData, int dwFlags);

	[DllImport("coredll.dll", EntryPoint = "CryptSetKeyParam", SetLastError = true)]
	private static extern int CryptSetKeyParamCE(IntPtr hKey, int dwParam, byte[] pbData, int dwFlags);

	[DllImport("coredll.dll", EntryPoint = "CryptGenRandom", SetLastError = true)]
	private static extern int CryptGenRandomCE(IntPtr hProv, int dwLen, byte[] pbBuffer);

	[DllImport("coredll.dll", EntryPoint = "CryptGenKey", SetLastError = true)]
	private static extern int CryptGenKeyCE(IntPtr hProv, int algID, uint dwFlags, out IntPtr phKey);

	[DllImport("coredll.dll", EntryPoint = "CryptEncrypt", SetLastError = true)]
	public static extern int CryptEncryptCE(IntPtr hKey, IntPtr hHash, int final, int dwFlags, IntPtr pbData, ref int pdwDataLen, int dwBufLen);

	[DllImport("coredll.dll", EntryPoint = "CryptVerifySignature", SetLastError = true)]
	public static extern int CryptVerifySignatureCE(IntPtr hHash, byte[] pbSignature, int dwSigLen, IntPtr hPubKey, IntPtr sDescription, int dwFlags);

	[DllImport("advapi32.dll", EntryPoint = "CryptGetProvParam", SetLastError = true)]
	private static extern int CryptGetProvParamNT(IntPtr hProv, int dwParam, byte[] pbData, ref int pdwDataLen, int dwFlags);

	[DllImport("advapi32.dll", CharSet = CharSet.Unicode, EntryPoint = "CryptAcquireContextW", SetLastError = true)]
	private static extern int CryptAcquireContextNT(out IntPtr hProv, string pszContainer, string pszProvider, int dwProvType, uint dwFlags);

	[DllImport("advapi32.dll", EntryPoint = "CryptReleaseContext", SetLastError = true)]
	private static extern int CryptReleaseContextNT(IntPtr hProv, int dwFlags);

	[DllImport("advapi32.dll", EntryPoint = "CryptGetUserKey", SetLastError = true)]
	private static extern int CryptGetUserKeyNT(IntPtr hProv, uint dwKeySpec, out IntPtr hUserKey);

	[DllImport("advapi32.dll", EntryPoint = "CryptDestroyKey", SetLastError = true)]
	private static extern int CryptDestroyKeyNT(IntPtr hKey);

	[DllImport("advapi32.dll", EntryPoint = "CryptCreateHash", SetLastError = true)]
	private static extern int CryptCreateHashNT(IntPtr hProv, int algID, IntPtr hKey, int dwFlags, out IntPtr phHash);

	[DllImport("advapi32.dll", EntryPoint = "CryptDestroyHash", SetLastError = true)]
	private static extern int CryptDestroyHashNT(IntPtr hHash);

	[DllImport("advapi32.dll", EntryPoint = "CryptHashData", SetLastError = true)]
	private static extern int CryptHashDataNT(IntPtr hHash, byte[] pbData, int dwDataLen, int dwFlags);

	[DllImport("advapi32.dll", EntryPoint = "CryptSetHashParam", SetLastError = true)]
	private static extern int CryptSetHashParamNT(IntPtr hHash, int dwParam, byte[] pbData, int dwFlags);

	[DllImport("advapi32.dll", EntryPoint = "CryptGetHashParam", SetLastError = true)]
	private static extern int CryptGetHashParamNT(IntPtr hHash, int dwParam, byte[] pbData, ref int pdwDataLen, int dwFlags);

	[DllImport("advapi32.dll", EntryPoint = "CryptSignHash", SetLastError = true)]
	private static extern int CryptSignHashNT(IntPtr hHash, int dwKeySpec, IntPtr sDescription, int dwFlags, byte[] pbSignature, ref int pdwSigLen);

	[DllImport("advapi32.dll", EntryPoint = "CryptDecrypt", SetLastError = true)]
	private static extern int CryptDecryptNT(IntPtr hKey, IntPtr hHash, int final, int dwFlags, byte[] pbData, ref int pdwDataLen);

	[DllImport("advapi32.dll", EntryPoint = "CryptImportKey", SetLastError = true)]
	private static extern int CryptImportKeyNT(IntPtr hProv, IntPtr pbData, int dwDataLen, IntPtr hPubKey, int dwFlags, out IntPtr phKey);

	[DllImport("advapi32.dll", EntryPoint = "CryptExportKey", SetLastError = true)]
	private static extern int CryptExportKeyNT(IntPtr hKey, IntPtr hExpKey, int dwBlobType, int dwFlags, IntPtr pbData, ref int pdwbDataLen);

	[DllImport("advapi32.dll", EntryPoint = "CryptSetKeyParam", SetLastError = true)]
	private static extern int CryptSetKeyParamNT(IntPtr hKey, int dwParam, IntPtr pbData, int dwFlags);

	[DllImport("advapi32.dll", EntryPoint = "CryptSetKeyParam", SetLastError = true)]
	private static extern int CryptSetKeyParamNT(IntPtr hKey, int dwParam, byte[] pbData, int dwFlags);

	[DllImport("advapi32.dll", EntryPoint = "CryptGenRandom", SetLastError = true)]
	private static extern int CryptGenRandomNT(IntPtr hProv, int dwLen, byte[] pbBuffer);

	[DllImport("advapi32.dll", EntryPoint = "CryptGenKey", SetLastError = true)]
	private static extern int CryptGenKeyNT(IntPtr hProv, int algID, uint dwFlags, out IntPtr phKey);

	[DllImport("advapi32.dll", EntryPoint = "CryptEncrypt", SetLastError = true)]
	public static extern int CryptEncryptNT(IntPtr hKey, IntPtr hHash, int final, int dwFlags, IntPtr pbData, ref int pdwDataLen, int dwBufLen);

	[DllImport("advapi32.dll", EntryPoint = "CryptVerifySignature", SetLastError = true)]
	public static extern int CryptVerifySignatureNT(IntPtr hHash, byte[] pbSignature, int dwSigLen, IntPtr hPubKey, IntPtr sDescription, int dwFlags);

	[DllImport("crypt32.dll", SetLastError = true)]
	public static extern int CertGetNameStringW(IntPtr pCertContext, uint dwType, uint dwFlags, IntPtr pvTypePara, IntPtr pszNameString, int cchNameString);

	public static long apvfl(long p0)
	{
		if (p0 == 0)
		{
			return 0L;
		}
		if ((p0 & 0x100000) != 0)
		{
			p0 = (p0 & -1048577) | 0x40000000000L;
		}
		if ((p0 & 0x4000000) != 0)
		{
			p0 = (p0 & -67108865) | 0x8000000000L;
		}
		if ((p0 & 0x8000000) != 0)
		{
			p0 = (p0 & -134217729) | 0x400000000L;
		}
		return p0;
	}
}
